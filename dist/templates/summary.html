<!DOCTYPE html>
<html lang="en">
<head>
  <mate charest="utf-8"/>
  <title>GitHub Advanced Security Report - Summary</title>

  <style type="text/css">
      .report {
          margin: 30px;
      }

      .heading {
          margin-bottom: 50px;
      }

      .section {
          margin-bottom: 50px;
      }

      .section-header {
          margin-bottom: 20px;
      }

      /*.row {*/
      /*    margin-bottom: 10px;*/
      /*}*/

      /* Allows for PDF to use coloured components */
      @media print {
          * {
              -webkit-print-color-adjust: exact;
          }
      }
  </style>

  <!-- Bootstrap CSS -->
  <link rel="stylesheet" href="https://stackpath.bootstrapcdn.com/bootstrap/4.5.2/css/bootstrap.min.css"
        integrity="sha384-JcKb8q3iqJ61gNV9KGb8thSsNjpSL0n8PARn9HuZOnIxN0hoP+VmmDGMN5t9UJ0Z" crossorigin="anonymous">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
</head>

<body>

<header class="container-fluid">
  <div class="row py-5 border-bottom"><!-- Title -->
    <div class="col-auto align-middle">
      <img src="https://github.githubassets.com/images/modules/logos_page/GitHub-Mark.png" height="100px" width="100px" />
    </div>

    <div class="col align-middle">
      <h1>GitHub Advanced Security<br>Executive Summary Report</h1>
    </div>
  </div><!-- Title -->

  <div class="row py-3 border-bottom"><!-- Metadata -->
    <div class="col">
      <dt>GitHub Repository:</dt>
      <dd>{{ github.owner }}/{{ github.repo }}</dd>
    </div>

    <div class="col">
      <dt>Generated:</dt>
      <dd>{{ metadata.created }}</dd>
    </div>
  </div><!-- Metadata -->
</header>


<main>
  <section class="container-fluid my-3">
    <div id="report-summary" class="row py-3"><!-- Summary -->
      <div class="col-12"><!-- CWE -->
        <h4>Common Weakness Enumeration (CWE)</h4>

        <div class="card my-2"><!-- CWE -->
          <div class="card-header">
            <h5 class="float-left">CWE Coverage</h5>
            <h5><span class="badge badge-light float-right">{{ scanning.cwe.cwes | length }}</span></h5>
          </div>
          <div class="card-body">
            <div>
              <ul class="list-inline">
                {% if scanning.cwe.cwes.total > 0 %}
                  {% for cwe in scanning.cwe.cwes | sort %}
                  <li class="text-monospace badge badge-secondary m-1">{{ cwe }}</li>
                  {% endfor %}
                {% else %}
                  <li class="text-monospace m-1">No CWE have been found.</li>
                {% endif %}
              </ul>
            </div>
          </div>
        </div>
      </div><!-- CWE -->

      <div class="col-6 mt-4"><!-- Code Scanning Status -->
        <h4>Code Scanning Status (Findings)</h4>

        <div class="card my-2"><!-- Code Scanning Rules Applied -->
          <div class="card-header">
            <h5 class="float-left">Code Scanning Rules Applied</h5>
            <h5><span class="badge badge-light float-right">{{ scanning.rules | length }}</span></h5>
          </div>
          <div class="card-body">
          </div>
        </div> <!-- Code Scanning Rules Applied -->

        <div class="card my-2"><!-- Open Findings -->
          <div class="card-header">
            <h5 class="float-left">Open Findings</h5>
            <h5><span class="badge badge-light float-right">{{ scanning.results.open.total }}</span></h5>
          </div>
          <div class="card-body">
            {% if scanning.results.open.total > 0 %}
            <button type="button" class="btn btn-danger w-100 my-1">
              Error <span class="badge badge-light">{{ scanning.results.open.scans.error | length }}</span>
            </button>
            <button type="button" class="btn btn-warning w-100 my-1">
              Warning <span class="badge badge-light">{{ scanning.results.open.scans.warning | length }}</span>
            </button>
            <button type="button" class="btn btn-secondary w-100 my-1">
              Recommendation <span class="badge badge-light">{{ scanning.results.open.scans.recommendation | length }}</span>
            </button>
            <button type="button" class="btn btn-info w-100 my-1">
              Note <span class="badge badge-light">{{ scanning.results.open.scans.note | length }}</span>
            </button>
            {% else %}
            <button type="button" class="btn btn-secondary w-100 my-1">
              No Results <span class="badge badge-light">0</span>
            </button>
            {% endif %}
          </div>
        </div><!-- Open Findings -->

        <div class="card my-2"><!-- Closed Findings -->
          <div class="card-header">
            <h5 class="float-left">Closed Findings</h5>
            <h5><span class="badge badge-light float-right">{{ scanning.results.closed.total }}</span></h5>
          </div>
          <div class="card-body">
            {% if scanning.results.closed.total > 0 %}
            <button type="button" class="btn btn-danger w-100 my-1">
              Error <span class="badge badge-light">{{ scanning.results.closed.scans.error | length }}</span>
            </button>
            <button type="button" class="btn btn-warning w-100 my-1">
              Warning <span class="badge badge-light">{{ scanning.results.closed.scans.warning | length }}</span>
            </button>
            <button type="button" class="btn btn-secondary w-100 my-1">
              Recommendation <span class="badge badge-light">{{ scanning.results.open.scans.recommendation | length }}</span>
            </button>
            <button type="button" class="btn btn-info w-100 my-1">
              Note <span class="badge badge-light">{{ scanning.results.open.scans.note | length }}</span>
            </button>
            {% else %}
            <button type="button" class="btn btn-secondary w-100 my-1">
              No Results <span class="badge badge-light">0</span>
            </button>
            {% endif %}
          </div>
        </div><!-- Closed Findings -->
      </div><!-- Code Scanning Status -->

      <div class="col-6 mt-4"><!-- SCA -->
        <h4>Software Composition Analysis (SCA)</h4>

        <div class="card my-2"><!-- Depedencies -->
          <div class="card-header">
            <h5 class="float-left">Dependencies</h5>
            <h5><span class="badge badge-light float-right">{{ sca.dependencies.totalDependencies }}</span></h5>
          </div>

          <div class="card-body">
            <button type="button" class="btn btn-danger w-100 my-1">
              Unprocessed manifests <span class="badge badge-light">{{ sca.dependencies.manifests.unprocessed | length }}</span>
            </button>
            <button type="button" class="btn btn-success w-100 my-1">
              Processed manifests <span
                class="badge badge-light">{{ sca.dependencies.manifests.processed | length }}</span>
            </button>
          </div>
        </div>

        <div class="card my-2"> <!-- Dependency Vulnerabilities -->
          <div class="card-header">
            <h5 class="float-left">Dependency Vulnerabilities</h5>
            <h5><span class="badge badge-light float-right">{{ sca.vulnerabilities.total }}</span></h5>
          </div>

          <div class="card-body">
            {% for severity, vulnerabilities in sca.vulnerabilities.bySeverity %}
              <button type="button" class="btn {% if severity == 'critical' %}btn-danger{% elif severity == 'high' %}btn-danger{% elif severity == 'moderate' %}btn-warning{% else %}btn-info{% endif %} w-100 my-1">
                {{ severity | capitalize }}&nbsp;
                <span class="badge badge-light">{{ vulnerabilities | length }}</span>
              </button>
            {% endfor %}
          </div>
        </div>
      </div><!-- SCA -->
    </div><!-- Summary -->
  </section>

</main>

</body>
</html>