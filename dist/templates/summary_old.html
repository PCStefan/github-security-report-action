<!DOCTYPE html>
<html>
<head>
  <mate charest="utf-8" />
  <title>GitHub Advanced Security Summary</title>
</head>

<body>
<h1>GitHub Advanced Security Summary</h1>

<h2>Software Composition Analysis (SCA)</h2>

<p>Number of Dependencies: {{ sca.dependencies.totalDependencies }}</p>

<h3>SCA Dependency Vulnerability Summary:</h3>
<p>
  <ul>
    <li>Critical: {{sca.dependencies.vulnerabilities.critical.length}}</li>
    <li>High: {{sca.dependencies.vulnerabilities.high.length}}</li>
    <li>Moderate: {{sca.dependencies.vulnerabilities.moderate.length}}</li>
    <li>Low: {{sca.dependencies.vulnerabilities.low.length}}</li>
  </ul>
</p>

<h2>Code Scanning</h2>
<p>
  Total CWE Vulnerabilities Checked: {{ scanning.cwe.cwes | length }}
<!--  <ul>-->
  <div>
    {{#each scanning.cwe.cwes}}
      <strong>{{ this }}</strong>
    {{/each}}
  </div>
<!--  </ul>-->
</p>

<h3>Open Violations</h3>
<ul>
  <li>Errors: {{ scanning.results.open.scans.error | length }}</li>
  <li>Warnings: {{ scanning.results.open.scans.warning | length}}</li>
</ul>

<h4>Errors</h4>
<table>
  <tr>
    <th>Tool</th>
    <th>Name</th>
    <th>Created</th>
    <th>Tags</th>
    <th>CWE</th>
    <th>Link</th>
  </tr>
  {{#each scanning.results.open.scans.error}}
  <tr>
    <td>{{this.tool}}</td>
    <td>{{this.name}}</td>
    <td>{{this.created}}</td>
    <td>{{this.rule.details.tags}}</td>
    <td>{{this.rule.details.cwes}}</td>
    <td>{{this.url}}</td>
  </tr>
  {{/each}}
</table>

<h4>Warnings</h4>
<table>
  <tr>
    <th>Tool</th>
    <th>Name</th>
    <th>Created</th>
    <th>Tags</th>
    <th>CWE</th>
    <th>Link</th>
  </tr>
  {{#each scanning.results.open.scans.warning}}
  <tr>
    <td>{{this.tool}}</td>
    <td>{{this.name}}</td>
    <td>{{this.created}}</td>
    <td>{{this.rule.tags}}</td>
    <td>{{this.rule.cwes}}</td>
    <td>{{this.url}}</td>
  </tr>
  {{/each}}
</table>

<h2>Dependencies Detail</h2>

<h3>Vulnerabilities</h3>

{{#if sca.vulnerabilities.bySeverity.critical | length}}
<h4>Critical</h4>
<table>
  <tr>
    <td>Package</td>
    <td>Ecosystem</td>
    <td>Version</td>
    <td>Manifest</td>
    <td>Severity</td>
    <td>Advisory Id</td>
    <td>Advisory Summary</td>
  </tr>
  {{#each sca.vulnerabilities.bySeverity.critical }}
  <tr>
    <td>{{this.vulnerability.package.name}}</td>
    <td>{{this.vulnerability.package.ecosystem}}</td>
    <td>{{this.vulnerability.package.vulnerableVersionRange}}</td>
    <td>{{this.source.path}}/{{this.source.manifest}}</td>
    <td>{{this.vulnerability.severity}}</td>
    <td>{{this.advisory.ghsaId}}</td>
    <td>{{this.advisory.summary}}</td>
  </tr>
  {{/each}}
</table>
{{/if}}

{{#if sca.vulnerabilities.bySeverity.high | length}}
<h4>Critical</h4>
<table>
  <tr>
    <td>Package</td>
    <td>Ecosystem</td>
    <td>Version</td>
    <td>Manifest</td>
    <td>Severity</td>
    <td>Advisory Id</td>
    <td>Advisory Summary</td>
  </tr>
  {{#each sca.vulnerabilities.bySeverity.high }}
  <tr>
    <td>{{this.vulnerability.package.name}}</td>
    <td>{{this.vulnerability.package.ecosystem}}</td>
    <td>{{this.vulnerability.package.vulnerableVersionRange}}</td>
    <td>{{this.source.path}}/{{this.source.manifest}}</td>
    <td>{{this.vulnerability.severity}}</td>
    <td>{{this.advisory.ghsaId}}</td>
    <td>{{this.advisory.summary}}</td>
  </tr>
  {{/each}}
</table>
{{/if}}

{{#if sca.vulnerabilities.bySeverity.moderate | length}}
<h4>Critical</h4>
<table>
  <tr>
    <td>Package</td>
    <td>Ecosystem</td>
    <td>Version</td>
    <td>Manifest</td>
    <td>Severity</td>
    <td>Advisory Id</td>
    <td>Advisory Summary</td>
  </tr>
  {{#each sca.vulnerabilities.bySeverity.moderate }}
  <tr>
    <td>{{this.vulnerability.package.name}}</td>
    <td>{{this.vulnerability.package.ecosystem}}</td>
    <td>{{this.vulnerability.package.vulnerableVersionRange}}</td>
    <td>{{this.source.path}}/{{this.source.manifest}}</td>
    <td>{{this.vulnerability.severity}}</td>
    <td>{{this.advisory.ghsaId}}</td>
    <td>{{this.advisory.summary}}</td>
  </tr>
  {{/each}}
</table>
{{/if}}

{{#if sca.vulnerabilities.bySeverity.low | length}}
<h4>Critical</h4>
<table>
  <tr>
    <td>Package</td>
    <td>Ecosystem</td>
    <td>Version</td>
    <td>Manifest</td>
    <td>Severity</td>
    <td>Advisory Id</td>
    <td>Advisory Summary</td>
  </tr>
  {{#each sca.vulnerabilities.bySeverity.low }}
  <tr>
    <td>{{this.vulnerability.package.name}}</td>
    <td>{{this.vulnerability.package.ecosystem}}</td>
    <td>{{this.vulnerability.package.vulnerableVersionRange}}</td>
    <td>{{this.source.path}}/{{this.source.manifest}}</td>
    <td>{{this.vulnerability.severity}}</td>
    <td>{{this.advisory.ghsaId}}</td>
    <td>{{this.advisory.summary}}</td>
  </tr>
  {{/each}}
</table>
{{/if}}

<h3>Detected Dependencies</h3>
<p>
  Maven Dependencies:
<table>
  <tr></tr>
  {{#each sca.dependencies.dependencies.maven}}
  <tr>
    <td>{{this.name}}</td>
    <td>{{this.version}}</td>
  </tr>
  {{/each}}
</table>
</p>
<p>
  NPM Dependencies:
<table>
  <tr></tr>
  {{#each sca.dependencies.dependencies.npm}}
  <tr>
    <td>{{this.name}}</td>
    <td>{{this.version}}</td>
  </tr>
  {{/each}}
</table>
</p>
<p>
  Nuget Dependencies:
<table>
  <tr></tr>
  {{#each sca.dependencies.dependencies.nuget}}
  <tr>
    <td>{{this.name}}</td>
    <td>{{this.version}}</td>
  </tr>
  {{/each}}
</table>
</p>
<p>
  Actions Dependencies:
<table>
  <tr></tr>
  {{#each sca.dependencies.dependencies.actions}}
  <tr>
    <td>{{this.name}}</td>
    <td>{{this.version}}</td>
  </tr>
  {{/each}}
</table>
</p>

</body>
</html>